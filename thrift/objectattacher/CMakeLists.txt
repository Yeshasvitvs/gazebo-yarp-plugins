cmake_minimum_required(VERSION 2.8.11)

set(LIBRARY_TARGET_NAME gazebo_yarp_rpc_objectattacher)

yarp_idl_to_dir(objectattacher_rpc.thrift ${CMAKE_CURRENT_SOURCE_DIR}/autogenerated OARPC_SRC OARPC_HEADERS OARPC_INCLUDES)

include_directories(${OARPC_INCLUDES} ${YARP_INCLUDE_DIRS})
add_library(${LIBRARY_TARGET_NAME} SHARED ${OARPC_SRC} ${OARPC_HEADERS})
target_link_libraries(${LIBRARY_TARGET_NAME} ${YARP_LIBRARIES})

set_target_properties(${LIBRARY_TARGET_NAME} PROPERTIES VERSION ${${PROJECT_NAME}_VERSION}
                                                        PUBLIC_HEADER "${OARPC_HEADERS}")

target_include_directories(${LIBRARY_TARGET_NAME} PUBLIC
                           "$<BUILD_INTERFACE:${OARPC_INCLUDES}>"
                           "$<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}/gazebo>")

set_property(TARGET ${LIBRARY_TARGET_NAME} PROPERTY PUBLIC_HEADER ${OARPC_HEADERS})

install(TARGETS ${LIBRARY_TARGET_NAME}
        EXPORT ${PROJECT_NAME}
        LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
        PUBLIC_HEADER DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/gazebo)

set_property(GLOBAL APPEND PROPERTY ${PROJECT_NAME}_TARGETS ${LIBRARY_TARGET_NAME})
